<!DOCTYPE html>
<html lang="en" class="no-js">
<!-- BEGIN HEAD -->
<head>
    <meta charset="utf-8"/>
    <title>Разработка высоконагруженной системы</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <meta content="" name="description"/>
    <meta content="" name="author"/>

    <!-- GLOBAL MANDATORY STYLES -->
    <link href="http://fonts.googleapis.com/css?family=Hind:300,400,500,600,700" rel="stylesheet" type="text/css">
    <link href="vendor/simple-line-icons/css/simple-line-icons.css" rel="stylesheet" type="text/css"/>
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>

    <!-- PAGE LEVEL PLUGIN STYLES -->
    <link href="css/animate.css" rel="stylesheet">
    <link href="vendor/swiper/css/swiper.min.css" rel="stylesheet" type="text/css"/>

    <!-- THEME STYLES -->
    <link href="css/layout.css" rel="stylesheet" type="text/css"/>

    <!-- Favicon -->
    <link rel="shortcut icon" href="favicon.ico"/>
</head>
<!-- END HEAD -->

<!-- BODY -->
<body id="body" data-spy="scroll" data-target=".header">

<!--========== HEADER ==========-->
<header class="header navbar-fixed-top">
    <!-- Navbar -->
    <nav class="navbar fixed-height" role="navigation">
        <div class="container fixed-height">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="menu-container js_nav-item">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="toggle-icon"></span>
                </button>

                <!-- Logo -->
                <div class="logo">
                    <a class="logo-wrap" href="#body">
                    </a>
                </div>
                <!-- End Logo -->
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse nav-collapse">
                <div class="menu-container">
                    <ul class="nav navbar-nav navbar-nav-right">
                        <a class="btn font btn-lg btn-primary" href="https://github.com/pyataevaev" target="_blank"><i
                                class="icon-github"></i>Code on Github</a>
                    </ul>
                </div>
            </div>
            <!-- End Navbar Collapse -->
        </div>
    </nav>
    <!-- Navbar -->
</header>
<!--========== END HEADER ==========-->

<!--========== SLIDER ==========-->
<div class="promo-block">
    <div class="container">
        <div class="row">
            <h1 class="promo-block-title">Разработка высоконагруженной распределенной системы</h1>

        </div>

    </div>
</div>
<!--// end row -->
</div>
</div>
<!--========== SLIDER ==========-->

<!--========== PAGE LAYOUT ==========-->
<div id="about">
    <div class="container content-lg">
        <div class="row">
            <div class="section-seperator">
                <div>
                    <div class="margin-b-30">
                        <h2>
                            Сегодня очень важно проектировать и разрабатывать систему, которая является
                            отказоустойчивой. Отказоустойчивость — свойство технической системы сохранять свою
                            работоспособность после
                            отказа одного или нескольких составных компонентов.
                            При пользовании разрабатываемой системы достаточно большого количества человек, данный
                            вопрос встает на передний план.
                            В результате анализа подходов к разработке высоконагруженных ситсем и анализа архитектуры
                            таких систем, были выделены основные преимущества
                            и недостатки, на основе чего спроектирвоанна архитектура разрабатываемой ситемы, которая
                            представлена на рисунке 1.</h2>
                        </br>
                        </br>
                        <p style="text-align: center"><img class="img" align="middle" src="img/architecture-queue.png"
                                                           alt=""></p>
                        <h5 style="text-align: center">Рисунок 1 - Архитектура разрабатываемой системы</h5>
                        <h2>
                            Заложим в архитектуру дополнительный уровень защиты – поместим каждый сервис в отдельный
                            контейнер, как это показано на рисуноке 2.  </h2>
                        </br>
                        </br>
                        <p style="text-align: center"><img class="img" align="middle"
                                                           src="img/architecture-queue-docker.png" alt=""></p>
                        <h5 style="text-align: center">Рисунок 2 - Архитектура системы c контейнерами</h5>
                        <h2>
                            Использование очередей сообщений в архитектуре распределенных систем довольно
                            распространенная техника разделения большой системы на компоненты. Основная задача очереди -
                            это гарантированное выполнение задач, находящихся в очереди. На рисунке 3 схематично
                            представлен процесс очереди сообщений. </h2>
                        </br>
                        </br>
                        <p style="text-align: center"><img class="img" align="middle"
                                                           src="img/ampq.png" alt=""></p>
                        <h5 style="text-align: center">Рисунок 3 - Работа очереди сообщений</h5>
                        <h2>
                            Суть работы очереди сообщений заключается в том, что один сервис (поставщик) при каком-то
                            действии добавляет в очередь сообщение, а затем другой сервис, на котором запущен слушатель,
                            проверяет очередь на добавленные сообщения, и в порядке добавления обрабатывает их.
                        </h2>
                        <h2>
                            Далее опишем, каким образом развернуть локально типовую структуру распределенного
                            высоконагруженного приложения, на примере системы университета, которое включает в себя
                            несколько базовых микросервисов: </br> </br>
                            <a class="nav-item-child nav-item-hover" href="#auth">1. Сервис авторизации</a> </br>
                            <a class="nav-item-child nav-item-hover" href="#log">2. Сервис логирования</a> </br>
                            <a class="nav-item-child nav-item-hover" href="#check-in">3. Сервис регистрации входа/выхода
                                студентов</a> </br>
                            <a class="nav-item-child nav-item-hover" href="#client">4. Сервис с клиентской
                                частью</a> </br>
                            Каждый из сервисов запускается в Docker контейнере.
                        </h2>
                        <h2>
                            На рисунке 4 показана структура приложения.
                            <p style="text-align: center"><img class="img" align="middle"
                                                               src="img/structure.png" alt=""></p>
                            <h5 style="text-align: center">Рисунок 4 - Структура приложения</h5>

                        </h2>
                        <h2>
                            Для повышения производительности системы используем две базы данных. Сервис авторизации и
                            регистрации входа/выхода студентов использует PostgreSQL. Сервис логирования - MongoDB.
                        </h2>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- auth -->
<div id="auth">
    <div class="container">
        <div class="row auth">
            <div class="section-seperator margin-b-50">
                <div>
                    <div class="margin-b-30">
                        <h4 class="header-my">1. Сервис авторизации</h4>
                        <h2>Реализацию сервиса авторизации можно скачать с Github по ссылке:
                            <a class="nav-item-child nav-item-hover" href="https://github.com/pyataevaev/auth-service"
                               target="_blank">Github репозиторий с сервисом авторизации</a> </br>
                            В директории src/docker/ находится Dockerfile, в котором описаны шаги сборки образа для
                            сервиса авторизации. Сам образ размещен на публичном хранилище образов
                            Docker Hub. Можно скачать данный образ и запустить на его основе контейнер локально. Сделать
                            это можно следующей командой: docker pull ekaterinach/auth. Пример докерфайла для запуска
                            сервиса авторизации преведен ниже.
                        </h2>

                        <pre><code>
 FROM ubuntu:14.04

 ENV DEBIAN_FRONTEND noninteractive
 RUN echo "debconf shared/accepted-oracle-license-v1-1 select true" | debconf-set-selections
 RUN echo "debconf shared/accepted-oracle-license-v1-1 seen true" | debconf-set-selections

 RUN apt-get update \
 	&& apt-get -y install software-properties-common python-software-properties \
 	bzip2 unzip openssh-client git \
 	lib32stdc++6 lib32z1 \
 	expect build-essential

 # Add oracle-jdk8 to repositories
 RUN add-apt-repository ppa:webupd8team/java -y

 # Update apt
 RUN apt-get update

 # Install oracle-jdk8
 RUN apt-get install -y oracle-java8-installer

 # Install Gradle
 RUN wget https://services.gradle.org/distributions/gradle-3.1-bin.zip
 RUN unzip gradle-3.1-bin.zip
 RUN mv gradle-3.1 /opt/
 RUN rm gradle-3.1-bin.zip

 # Environment variables
 ENV GRADLE_HOME /opt/gradle-3.1
 ENV PATH $PATH:$GRADLE_HOME/bin

 # Export JAVA_HOME variable
 ENV JAVA_HOME /usr/lib/jvm/java-8-oracle

 RUN cd ~/
 RUN git clone https://github.com/pyataevaev/auth-service.git auth
 WORKDIR "auth"
 RUN gradle build
 EXPOSE 8080

 CMD ["java", "-jar", "build/libs/auth-service-1.0.jar"]
                                    </code></pre>

                        <h2>
                            Чтобы на основе данного докерфайла создать контейнер, необходимо перейти в директорию, в
                            которой находится Dockerfile и выполнить команду:
                            <pre><code>
docker build -t auth-service:last .
                            </code></pre>
                            В результате выполнения данной команды создастся докер образ с названием auth-service. Чтобы
                            на основе полученного образа запустить контейнер, необходимо выполнить команду:
                            <pre><code>
docker run -d -p 80:80 auth-service
                            </code></pre>
                            В результате сервис авторизации будет запущен на порту 8080.
                        </h2>
                    </div>
                </div>
            </div>
        </div>
        <!--// end row -->
    </div>
</div>
<!-- End auth -->

<!-- log -->
<div id="log">
    <div class="container">
        <div class="row">
            <div class="section-seperator margin-b-50">
                <div>
                    <div class="margin-b-30">
                        <h4 class="header-my">2. Сервис логирования</h4>
                        <h2>Реализацию сервиса авторизации можно скачать с Github по ссылке:
                            <a class="nav-item-child nav-item-hover"
                               href="https://github.com/pyataevaev/logging-service" target="_blank">Github репозиторий с
                                логирования </a> </br>
                            В директории src/docker/ находится Dockerfile, в котором описаны шаги сборки образа для
                            сервиса авторизации. Сам образ размещен на публичном хранилище образов
                            Docker Hub. Можно скачать данный образ и запустить на его основе контейнер локально. Сделать
                            это можно следующей командой: docker pull ekaterinach/logging. Следующие шаги по созданию
                            образа и запуска контейнера аналогичны пункту 1. Приведем пример докерфайла для запуска
                            сервиса логирования.

                        </h2>
                        <pre><code>
 FROM ubuntu:14.04

 ENV DEBIAN_FRONTEND noninteractive
 RUN echo "debconf shared/accepted-oracle-license-v1-1 select true" | debconf-set-selections
 RUN echo "debconf shared/accepted-oracle-license-v1-1 seen true" | debconf-set-selections

 RUN apt-get update \
 	&& apt-get -y install software-properties-common python-software-properties \
 	bzip2 unzip openssh-client git \
 	lib32stdc++6 lib32z1 \
 	expect build-essential

 # Add oracle-jdk8 to repositories
 RUN add-apt-repository ppa:webupd8team/java -y

 # Update apt
 RUN apt-get update

 # Install oracle-jdk8
 RUN apt-get install -y oracle-java8-installer

 # Install Gradle
 RUN wget https://services.gradle.org/distributions/gradle-3.1-bin.zip
 RUN unzip gradle-3.1-bin.zip
 RUN mv gradle-3.1 /opt/
 RUN rm gradle-3.1-bin.zip

 # Environment variables
 ENV GRADLE_HOME /opt/gradle-3.1
 ENV PATH $PATH:$GRADLE_HOME/bin

 # Export JAVA_HOME variable
 ENV JAVA_HOME /usr/lib/jvm/java-8-oracle

 RUN cd ~/
 RUN git clone https://github.com/pyataevaev/logging-service.git log-service
 WORKDIR "log-service"
 RUN gradle build
 EXPOSE 8082

 CMD ["java", "-jar", "build/libs/log-service-1.0.jar"]
                            </code>
                            </pre>
                        <h2>В результате сервис логирования будет запущен на порту 8082.</h2>
                    </div>
                </div>
            </div>
        </div>
        <!--// end row -->
    </div>
</div>
<!-- End log -->

<!-- check-in -->
<div id="check-in">
    <div class="container">
        <div class="row">
            <div class="section-seperator margin-b-50">
                <div>
                    <div class="margin-b-30">
                        <h4 class="header-my">3. Сервис регистрации входа/выхода студентов</h4>
                        <h2>Реализацию сервиса авторизации можно скачать с Github по ссылке:
                            <a class="nav-item-child nav-item-hover"
                               href="https://github.com/pyataevaev/logging-service" target="_blank">Github репозиторий с
                                логирования </a> </br>
                            В директории src/docker/ находится Dockerfile, в котором описаны шаги сборки образа для
                            сервиса авторизации. Сам образ размещен на публичном хранилище образов
                            Docker Hub. Можно скачать данный образ и запустить на его основе контейнер локально. Сделать
                            это можно следующей командой: docker pull ekaterinach/check-in. Следующие шаги по созданию
                            образа и запуска контейнера аналогичны пункту 1. Приведем пример докерфайла для запуска
                            сервиса входа/выхода студентов.
                        </h2>
                        <pre><code>

 FROM ubuntu:14.04

 ENV DEBIAN_FRONTEND noninteractive
 RUN echo "debconf shared/accepted-oracle-license-v1-1 select true" | debconf-set-selections
 RUN echo "debconf shared/accepted-oracle-license-v1-1 seen true" | debconf-set-selections

 RUN apt-get update \
 	&& apt-get -y install software-properties-common python-software-properties \
 	bzip2 unzip openssh-client git \
 	lib32stdc++6 lib32z1 \
 	expect build-essential

 # Add oracle-jdk8 to repositories
 RUN add-apt-repository ppa:webupd8team/java -y

 # Update apt
 RUN apt-get update

 # Install oracle-jdk8
 RUN apt-get install -y oracle-java8-installer

 # Install Gradle
 RUN wget https://services.gradle.org/distributions/gradle-3.1-bin.zip
 RUN unzip gradle-3.1-bin.zip
 RUN mv gradle-3.1 /opt/
 RUN rm gradle-3.1-bin.zip

 # Environment variables
 ENV GRADLE_HOME /opt/gradle-3.1
 ENV PATH $PATH:$GRADLE_HOME/bin

 # Export JAVA_HOME variable
 ENV JAVA_HOME /usr/lib/jvm/java-8-oracle

 RUN cd ~/
 RUN git clone https://github.com/pyataevaev/check-in-service.git check-in-service
 WORKDIR "check-in-service"
 RUN gradle build
 EXPOSE 8081

 CMD ["java", "-jar", "build/libs/check-in-service-1.0.jar"]

                        </code>
                        </pre>
                        <h2>В результате сервис отслеживания студентов будет запущен на порту 8081.</h2>
                    </div>
                </div>
            </div>
        </div>
        <!--// end row -->
    </div>
</div>
<!-- End check-in -->


<!-- client -->
<div id="client">
    <div class="container">
        <div class="row">
            <div class="section-seperator margin-b-50">
                <div>
                    <div class="margin-b-30">
                        <h4 class="header-my">4. Сервис с клиентской частью</h4>
                        <h2>Реализацию сервиса авторизации можно скачать с Github по ссылке:
                            <a class="nav-item-child nav-item-hover" href="https://github.com/pyataevaev/client"
                               target="_blank">Github репозиторий с сервисом авторизации</a> </br>
                            В директории src/docker/ находится Dockerfile, в котором описаны шаги сборки образа для
                            сервиса авторизации. Сам образ размещен на публичном хранилище образов
                            Docker Hub. Можно скачать данный образ и запустить на его основе контейнер локально. Сделать
                            это можно следующей командой: docker pull ekaterinach/client. Следующие шаги по созданию
                            образа и запуска контейнера аналогичны пункту 1. Приведем пример докерфайла для запуска
                            сервиса с клиентской частью.
                        </h2>

                        <pre><code>
FROM node:8-alpine as builder

COPY package.json package-lock.json ./

RUN npm set progress=false && npm config set depth 0 && npm cache clean --force

## Storing node modules on a separate layer will prevent unnecessary npm installs at each build
RUN npm i && mkdir /ng-app && cp -R ./node_modules ./ng-app

WORKDIR /ng-app

COPY . .

## Build the angular app in production mode and store the artifacts in dist folder
RUN $(npm bin)/ng build

FROM nginx:1.13.3-alpine

## Copy our default nginx config
COPY nginx/default.conf /etc/nginx/conf.d/

## Remove default nginx website
RUN rm -rf /usr/share/nginx/html/*

## From 'builder' stage copy over the artifacts in dist folder to default nginx public folder
COPY --from=builder /ng-app/dist /usr/share/nginx/html

CMD ["nginx", "-g", "daemon off;"]
                       </code>
                       </pre>
                        <h2>В результате сервис с клиентской частью будет запущен на порту 4200.</h2>
                    </div>
                </div>
            </div>
        </div>
        <!--// end row -->
    </div>
</div>
<!-- End client -->




<div>
    <div class="container">
        <div class="row">
            <div class="section-seperator margin-b-50">
                <div>
                    <div class="margin-b-30">
                        <h4 class="header-my">Запуск системы с помощью Docker Compose</h4>
                        <h2>Таким образом мы запустили все нужные нам сервисы для работы системы. Однако есть более удобный способ, особенно если количество сервисов достаточно большое - использовать инструмент Docker Compose.
                            Приведем привер файла docker-compose.yml, в котором описаны все микросервисы.
                        </h2>

                        <pre><code>
version: '2'
 services:
   auth:
     image: ekaterinach/auth
     ports:
       - "8080:8080"
   client:
     image: ekaterinach/client
     ports:
       - "4200:80"
   check-in:
     image: ekaterinach/check-in
     ports:
       - "27017:27017"
   logging:
     image: ekaterinach/logging
     ports:
       - "27017:27017"
                       </code>
                       </pre>
                        <h2>Чтобы запустить все описанные контейнеры, необходимо перейти в папку с файлом docker-compose.yml и выполнить команду:</h2>
                        <pre>
                        <code>
 docker-compose up
                        </code>
                        </pre>

                        <h2>Далее, чтобы использовать уже существующие образы, добавим в файл docker-compose.yml писание для сервисов PostgreSQL, MongoDB и RabbitMQ, котрые используют официальные образы, размещенные на платформе Docker Hub.
                        В результате файл docker-compose.yml приобретет следующий вид:</h2>

                        <pre><code>
version: '2'
 services:
   auth:
     image: ekaterinach/auth
     ports:
       - "8080:8080"
     depends_on:
       - mypostgres
   mypostgres:
     image: ekaterinach/postgrestest
     ports:
       - "5432:5432"
   client:
     image: ekaterinach/client
     ports:
       - "4200:80"
   check-in:
     image: ekaterinach/check-in
     ports:
       - "27017:27017"
   logging:
     image: ekaterinach/logging
     ports:
       - "27017:27017"
   mongodb:
     image: mongo
     ports:
       - "27017:27017"
   rabbitmq:
     image: rabbitmq:management
     ports:
       - "5672:5672"
       - "15672:15672"
                       </code>
                       </pre>

                        <h2>
                            Таким образом, представлено пошаговое руководство для разворачивания локально системы с помощью технологии Docker и инструмента Docker Compose.
                        </h2>
                    </div>
                </div>
            </div>
        </div>
        <!--// end row -->
    </div>
</div>
<!-- End client -->


<!-- Clients -->
<div class="bg-color-sky-light">
    <div class="content-lg container">
        <!-- Swiper Clients -->
        <div class="swiper-slider swiper-clients">
            <!-- Swiper Wrapper -->
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <img class="swiper-clients-img java" src="img/clients/java-logo.png" alt="Clients Logo">
                </div>
                <div class="swiper-slide">
                    <img class="swiper-clients-img" src="img/clients/pring_logo.png" alt="Clients Logo">
                </div>
                <div class="swiper-slide">
                    <img class="swiper-clients-img" src="img/clients/postgresql-logo.png" alt="Clients Logo">
                </div>
                <div class="swiper-slide">
                    <img class="swiper-clients-img" src="img/clients/mongo.png" alt="Clients Logo">
                </div>
                <div class="swiper-slide">
                    <img class="swiper-clients-img" src="img/clients/rabbitmq.png" alt="Clients Logo">
                </div>
                <div class="swiper-slide">
                    <img class="swiper-clients-img" src="img/clients/angular4.png" alt="Clients Logo">
                </div>
                <div class="swiper-slide">
                    <img class="swiper-clients-img" src="img/clients/docker.png" alt="Clients Logo">
                </div>
            </div>
            <!-- End Swiper Wrapper -->
        </div>
        <!-- End Swiper Clients -->
    </div>
</div>
<!-- End Clients -->

<!-- Promo Banner -->
<div class="promo-banner parallax-window" data-parallax="scroll" data-image-src="img/1920x1080/01.jpg">
    <div class="container-sm content-lg">
        <p> </br></br></br></br></br></br></br></br></br></br></br></br></br></p>
    </div>
</div>
<!-- End Promo Banner -->

<!-- Contact -->
<div id="contact">
    <div class="bg-color-sky-light">
        <div class="container content-lg">
            <div class="row margin-b-40">
                <div class="col-sm-6">
                    <h2>Контакты:</h2>
                </div>
            </div>
            <!--// end row -->

            <div class="row">
                <div class="col-md-3 col-xs-6" style="padding-bottom: 50px;">
                    <h4>Почта</h4>
                    <a href="mailto:#">katy94fm@mail.ru</a>
                </div>
            </div>
            <!--// end row -->
        </div>
    </div>
</div>
<!-- End Contact -->
<!--========== END PAGE LAYOUT ==========-->

<!--========== FOOTER ==========-->

<!--========== END FOOTER ==========-->

<!-- Back To Top -->
<a href="javascript:void(0);" class="js-back-to-top back-to-top">Top</a>

<!-- JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
<!-- CORE PLUGINS -->
<script src="vendor/jquery.min.js" type="text/javascript"></script>
<script src="vendor/jquery-migrate.min.js" type="text/javascript"></script>
<script src="vendor/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>

<!-- PAGE LEVEL PLUGINS -->
<script src="vendor/jquery.easing.js" type="text/javascript"></script>
<script src="vendor/jquery.back-to-top.js" type="text/javascript"></script>
<script src="vendor/jquery.smooth-scroll.js" type="text/javascript"></script>
<script src="vendor/jquery.wow.min.js" type="text/javascript"></script>
<script src="vendor/jquery.parallax.min.js" type="text/javascript"></script>
<script src="vendor/jquery.appear.js" type="text/javascript"></script>
<script src="vendor/swiper/js/swiper.jquery.min.js" type="text/javascript"></script>

<!-- PAGE LEVEL SCRIPTS -->
<script src="js/layout.min.js" type="text/javascript"></script>
<script src="js/components/progress-bar.min.js" type="text/javascript"></script>
<script src="js/components/swiper.min.js" type="text/javascript"></script>
<script src="js/components/wow.min.js" type="text/javascript"></script>

</body>
<!-- END BODY -->
</html>